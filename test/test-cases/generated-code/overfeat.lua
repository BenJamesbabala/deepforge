require 'nn'

model = nn.Sequential()
model:add(nn.SpatialConvolution(3, 96, 11, 11, 4))
model:add(nn.ReLU())
model:add(nn.SpatialMaxPooling(2, 2, 2))
model:add(nn.SpatialConvolution(96, 256, 5, 5, 1))
model:add(nn.ReLU())
model:add(nn.SpatialMaxPooling(2, 2, 2))
model:add(nn.SpatialConvolution(256, 512, 3, 3, 1))
model:add(nn.ReLU())
model:add(nn.SpatialConvolution(512, 1024, 3, 3, 1))
model:add(nn.ReLU())
model:add(nn.SpatialConvolution(1024, 1024, 3, 3, 1))
model:add(nn.ReLU())
model:add(nn.SpatialMaxPooling(2, 2, 2))
model:add(nn.View(25600))
model:add(nn.Dropout(0.5))
model:add(nn.Linear(1024, 3072))
model:add(nn.Threshold(0, 0.000001, ))
model:add(nn.Dropout(0.5))
model:add(nn.Linear(3072, 4096))
model:add(nn.Threshold(0, 0.000001, ))
model:add(nn.Linear(4096, 7))
model:add(nn.LogSoftMax())